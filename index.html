
<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JP Flash</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class'
    }
  </script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-100 min-h-screen p-4">
  <div class="max-w-xl mx-auto space-y-4">
    <div class="flex justify-between items-center">
      <h1 class="text-2xl font-bold">JP Flash</h1>
      <button onclick="toggleDarkMode()" class="text-xl" id="darkToggle">ðŸŒ™</button>
    </div>

    <div id="modeSelectPanel" class="space-y-4">
      <p class="text-lg font-medium">Choose a mode</p>
      <button onclick="startFlashcardMode()" class="w-full p-3 rounded bg-purple-600 text-white hover:bg-purple-700">Flashcard Mode</button>
      <button onclick="startInputMode()" class="w-full p-3 rounded bg-blue-600 text-white hover:bg-blue-700">Input Mode</button>
    </div>

    <div id="flashcardPanel" class="hidden space-y-4 bg-white dark:bg-gray-800 p-4 rounded-xl shadow">
      <div class="text-center font-semibold text-xl" id="cardFront">Flashcard front</div>
      <div class="text-center hidden font-medium text-lg" id="cardBack">Flashcard back</div>
      <div class="flex justify-center gap-4">
        <button onclick="flipCard()" class="px-4 py-2 bg-gray-300 dark:bg-gray-600 rounded">Flip</button>
        <button onclick="nextCard()" class="px-4 py-2 bg-purple-500 text-white rounded">Next</button>
      </div>
    </div>

    <div id="inputPanel" class="hidden space-y-4 bg-white dark:bg-gray-800 p-4 rounded-xl shadow">
      <div class="text-xl font-semibold" id="inputPrompt">Input Prompt</div>
      <input id="userInput" class="w-full p-2 text-black rounded" placeholder="Type your answer..." />
      <button onclick="submitAnswer()" class="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700">Submit</button>
      <div id="feedback" class="text-sm min-h-[1.5rem]"></div>
      <div class="text-right text-sm" id="scoreDisplay">0 / 0 correct</div>
      <div class="flex justify-between text-xs text-gray-500">
        <button onclick="toggleDirection()">Switch: <span id="directionLabel">EN â†’ JP</span></button>
        <button onclick="resetInputMode()">Restart</button>
      </div>
    </div>
  </div>

<script>
let cards = [], currentIndex = 0, flipped = false;
let inputMode = false, direction = 'en->jp', correct = 0, total = 0;

function toggleDarkMode() {
  const root = document.documentElement;
  const toggle = document.getElementById('darkToggle');
  const isDark = root.classList.toggle('dark');
  toggle.textContent = isDark ? "ðŸŒ™" : "â˜€ï¸";
}

function loadCards() {
  fetch('./words_verbs.json').then(res => res.json()).then(data => {
    cards = shuffle(data);
    currentIndex = 0;
    flipped = false;
    correct = 0;
    total = 0;
    inputMode ? showInputPrompt() : showFlashcard();
  });
}

function shuffle(arr) {
  return [...arr].sort(() => Math.random() - 0.5);
}

function startFlashcardMode() {
  inputMode = false;
  document.getElementById('modeSelectPanel').classList.add('hidden');
  document.getElementById('flashcardPanel').classList.remove('hidden');
  document.getElementById('inputPanel').classList.add('hidden');
  loadCards();
}

function startInputMode() {
  inputMode = true;
  document.getElementById('modeSelectPanel').classList.add('hidden');
  document.getElementById('flashcardPanel').classList.add('hidden');
  document.getElementById('inputPanel').classList.remove('hidden');
  loadCards();
}

function showFlashcard() {
  const card = cards[currentIndex];
  document.getElementById('cardFront').textContent = card.english;
  document.getElementById('cardBack').textContent = `${card.romaji} (${card.hiragana})`;
  document.getElementById('cardBack').classList.add('hidden');
}

function flipCard() {
  const back = document.getElementById('cardBack');
  back.classList.toggle('hidden');
}

function nextCard() {
  currentIndex = (currentIndex + 1) % cards.length;
  flipped = false;
  showFlashcard();
}

function showInputPrompt() {
  const card = cards[currentIndex];
  document.getElementById('userInput').value = '';
  document.getElementById('feedback').textContent = '';
  document.getElementById('inputPrompt').textContent =
    direction === 'en->jp' ? card.english : `${card.romaji} (${card.hiragana})`;
}

function submitAnswer() {
  const card = cards[currentIndex];
  const input = document.getElementById('userInput').value.trim().toLowerCase();
  const correctAns = direction === 'en->jp' ? card.romaji.toLowerCase() : card.english.toLowerCase();
  total++;
  if (input === correctAns) {
    correct++;
    document.getElementById('feedback').textContent = 'âœ… Correct!';
    document.getElementById('feedback').className = 'text-green-500';
  } else {
    document.getElementById('feedback').textContent = `âŒ Correct: ${correctAns}`;
    document.getElementById('feedback').className = 'text-red-500';
  }
  updateScore();
  setTimeout(() => {
    currentIndex = (currentIndex + 1) % cards.length;
    showInputPrompt();
  }, 1000);
}

function updateScore() {
  document.getElementById('scoreDisplay').textContent = `${correct} / ${total} correct`;
}

function toggleDirection() {
  direction = direction === 'en->jp' ? 'jp->en' : 'en->jp';
  document.getElementById('directionLabel').textContent = direction === 'en->jp' ? 'EN â†’ JP' : 'JP â†’ EN';
  resetInputMode();
}

function resetInputMode() {
  cards = shuffle(cards);
  currentIndex = 0;
  correct = 0;
  total = 0;
  updateScore();
  showInputPrompt();
}
</script>
</body>
</html>
