<!DOCTYPE html>
<html lang="en" class="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>JP Flash</title>
  <script>
    tailwind = {{ config: { darkMode: 'class' } }}
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .hidden { display: none; }
    .active-btn {
      background-color: #8b5cf6;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen flex items-center justify-center p-4">
  <div class="bg-white dark:bg-gray-800 p-6 rounded-xl shadow-lg w-full max-w-md text-center space-y-6">
    <div class="flex justify-between items-center">
      <h1 class="text-xl font-bold">JP Flash</h1>
      <button onclick="toggleDarkMode()" id="darkToggle">üåô</button>
    </div>

    <!-- Step 1: Select Category -->
    <div id="categorySelect" class="space-y-4">
      <p class="text-lg font-medium">Select a Category</p>
      <div id="categoryButtons" class="flex flex-wrap justify-center gap-2">
        <button class="category-btn px-4 py-2 rounded bg-gray-300 dark:bg-gray-700" onclick="selectCategory('verbs')">Verbs</button>
        <button class="category-btn px-4 py-2 rounded bg-gray-300 dark:bg-gray-700" onclick="selectCategory('nouns')">Nouns</button>
        <button class="category-btn px-4 py-2 rounded bg-gray-300 dark:bg-gray-700" onclick="selectCategory('adjectives')">Adjectives</button>
        <button class="category-btn px-4 py-2 rounded bg-gray-300 dark:bg-gray-700" onclick="selectCategory('pronouns')">Pronouns</button>
        <button class="category-btn px-4 py-2 rounded bg-gray-300 dark:bg-gray-700" onclick="selectCategory('counters')">Counters</button>
      </div>
    </div>

    <!-- Step 2: Select Subcategory -->
    <div id="subcategorySelect" class="hidden space-y-4">
      <p class="text-lg font-medium">Select a Subcategory</p>
      <div id="subcategoryButtons" class="flex flex-wrap justify-center gap-2"></div>
      <button onclick="goHome()" class="mt-4 text-sm text-blue-400 underline">‚Üê Back to Categories</button>
    </div>

    <!-- Flashcard Panel -->
    <div id="flashcardPanel" class="hidden space-y-4">
      <div class="bg-gray-200 dark:bg-gray-700 p-6 rounded-xl text-lg" id="flashcard"></div>
      <button onclick="nextCard()" class="px-6 py-2 bg-purple-500 text-white rounded hover:bg-purple-600">Next</button>
      <button onclick="goHome()" class="text-sm text-blue-400 underline">‚Üê Home</button>
    </div>
  </div>

<script>
const subcategories = {
  verbs: ["actions", "movement", "emotions"],
  nouns: ["people", "places", "objects"],
  adjectives: ["colors", "sizes"],
  pronouns: [""],
  counters: [""]
};

let cards = [];
let currentCard = 0;

function toggleDarkMode() {
  document.documentElement.classList.toggle("dark");
  const icon = document.getElementById("darkToggle");
  icon.textContent = document.documentElement.classList.contains("dark") ? "üåô" : "‚òÄÔ∏è";
}

function selectCategory(category) {
  document.getElementById("categorySelect").classList.add("hidden");
  document.getElementById("subcategorySelect").classList.remove("hidden");

  const container = document.getElementById("subcategoryButtons");
  container.innerHTML = "";

  subcategories[category].forEach(sub => {
    const label = sub ? sub.toUpperCase() : category.toUpperCase();
    const filename = `words_${category}${sub ? "_" + sub : ""}.json`;

    const btn = document.createElement("button");
    btn.className = "px-4 py-2 rounded bg-gray-300 dark:bg-gray-700";
    btn.textContent = label;
    btn.onclick = () => loadFlashcards(filename);
    container.appendChild(btn);
  });
}

function goHome() {
  document.getElementById("categorySelect").classList.remove("hidden");
  document.getElementById("subcategorySelect").classList.add("hidden");
  document.getElementById("flashcardPanel").classList.add("hidden");
}

function loadFlashcards(file) {
  fetch(file)
    .then(res => res.json())
    .then(data => {
      cards = data;
      currentCard = 0;
      showFlashcard();
      document.getElementById("subcategorySelect").classList.add("hidden");
      document.getElementById("flashcardPanel").classList.remove("hidden");
    });
}

function showFlashcard() {
  const card = cards[currentCard];
  let content = `<div class="text-xl font-semibold mb-2">${card.english}</div>`;
  if (card.romaji) content += `<div>${card.romaji}</div>`;
  if (card.formal) content += `<div>${card.formal}</div>`;
  if (card.hiragana) content += `<div>${card.hiragana}</div>`;
  if (card.counter) content += `<div class="mt-2 text-sm text-gray-400">${card.counter}</div>`;
  document.getElementById("flashcard").innerHTML = content;
}

function nextCard() {
  currentCard = (currentCard + 1) % cards.length;
  showFlashcard();
}
</script>
</body>
</html>
